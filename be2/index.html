<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Basic English II Learning App</title>
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&family=Noto+Sans+JP:wght@400;500;700&display=swap');
        
        body {
            font-family: 'Inter', 'Noto Sans JP', sans-serif;
            background-color: #f0f4f8;
            /* Prevent pull-to-refresh on mobile */
            overscroll-behavior-y: none;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .animate-slide-up {
            animation: slideUp 0.3s ease-out forwards;
        }

        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- ICONS (SVG Components) ---
        // 外部ライブラリ依存を削除し、直接定義して安定性を確保
        const Icons = {
            BookOpen: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>,
            CheckCircle: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>,
            XCircle: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>,
            Star: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>,
            Trophy: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17"/><path d="M14 14.66V17"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/><path d="M8.5 22v-2.14A10 10 0 0 1 3.35 15.6C3 15 3 14.35 3 13.75V13a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v.75c0 .6 0 1.25-.35 1.85A10 10 0 0 1 15.5 19.86V22"/></svg>,
            ArrowLeft: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>,
            Play: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><polygon points="5 3 19 12 5 21 5 3"/></svg>,
            Check: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><polyline points="20 6 9 17 4 12"/></svg>,
            Menu: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg>
        };

        // --- DATA: ALL LESSONS ---
        const APP_DATA = [
            {
                id: "L1",
                title: "Lesson 1: Part 5 動詞(1)",
                sections: [
                    {
                        id: "L1_TARGET",
                        title: "TODAY'S TARGET TEST",
                        type: "grammar",
                        questions: [
                            { text: "The film Out in Space received mostly positive reviews and was highly _______ for its brilliant visual effects.", options: ["praise", "praised", "praises", "praising"], correct: 1, explanation: "受動態の文です。「be動詞(was) + highly + 過去分詞」の形になります。praised（賞賛された）が正解です。" },
                            { text: "Warmly _______ by the employees in the Overton branch, the president felt glad he had come all the way despite his busy schedule.", options: ["welcome", "welcomed", "welcomes", "welcoming"], correct: 1, explanation: "分詞構文です。「（従業員によって）温かく迎えられたので」という受動の意味になるため、過去分詞の Welcomed が適切です。" },
                            { text: "Gina Carson could not give a prompt reply when _______ a managerial position at a rival company.", options: ["offer", "offered", "offering", "offers"], correct: 1, explanation: "接続詞(when)の後の分詞構文です。「オファーされた時」という受動の意味なので offered が正解です。" },
                            { text: "Three people were randomly _______ from the audience and brought up on stage to try a new computer game.", options: ["select", "selected", "selecting", "selects"], correct: 1, explanation: "受動態「were + 過去分詞」の形です。選ばれたので selected が正解です。" },
                            { text: "_______ as the project leader, Scott Thorne delegated various tasks to his team members at the meeting.", options: ["Being chosen", "Choose", "Choosing", "Chose"], correct: 3, explanation: "文脈判断です。Scott Thorneが主語で、'Chose' (選んだ) ではなく、文構造的には分詞構文の可能性がありますが、文脈的には「プロジェクトリーダーとして選ばれて（Being chosen）」か、あるいは単純に「選んだ（Chose）」か。しかし、選択肢の並びと文脈（彼がタスクを割り振った）から、彼がリーダーとして「選ばれたので（Chosen）」と言いたいところですが、選択肢に Chosen 単体がないため、(A) Being chosen（選ばれて）が文法的に最も自然です。※ただし、OCR元の正解が Chose (過去形能動) の可能性も考慮しますが、文法的には Being chosen が適切です。ここでは文脈的に彼がリーダーとして振る舞っているので (A) を正解とします。" },
                            { text: "The lawyer argued in court that his client _______ illegally in prison and should be released right away.", options: ["held", "holds", "is being held", "is holding"], correct: 2, explanation: "「不当に拘束されている（現在進行形の受動態）」という意味にする必要があります。is being held が正解です。" },
                            { text: "The sales director proposed that the campaign materials _______ printed in English as well as in Japanese.", options: ["are", "be", "were", "would be"], correct: 1, explanation: "提案・要求を表す動詞(propose)に続くthat節内では、動詞の原形を用います（仮定法現在）。したがって be が正解です。" },
                            { text: "After all the applications are reviewed, qualified candidates will _______ to schedule an interview.", options: ["be called", "call", "called", "calling"], correct: 0, explanation: "候補者は「呼ばれる」側なので、受動態の will be called が正解です。" },
                            { text: "The Chinese automaker's latest model comes _______ with a remote control to park the car in tight spots.", options: ["equip", "equipped", "equipping", "equips"], correct: 1, explanation: "come equipped with で「～が装備されている」という慣用表現です。" },
                            { text: "The meeting will be _______ by a reception where light refreshments will be served.", options: ["follow", "followed", "following", "follows"], correct: 1, explanation: "受動態「will be followed by...」（～の後に...が続く）の形です。" },
                            { text: "The excellent works from the annual art competition _______ at Oakland City Museum through March.", options: ["are being displayed", "are displaying", "display", "displayed"], correct: 0, explanation: "作品は「展示されている」最中なので、現在進行形の受動態 are being displayed が正解です。" },
                            { text: "Fedelico's, _______ in the heart of River City, has been a popular restaurant in the city for over 50 years.", options: ["situate", "situated", "situating", "to situate"], correct: 1, explanation: "分詞の後置修飾（または挿入句）です。「～に位置する」は situated を使います。" },
                            { text: "_______ for her best-selling nature photography books, Naomi Ward opens a photography school next month.", options: ["Know", "Knowing", "Known", "To know"], correct: 2, explanation: "分詞構文です。「～で知られている」という意味なので、過去分詞 Known で文を始めます。" },
                            { text: "Because his report was due today, Chad Anderson had his colleague _______ him with it.", options: ["help", "helped", "helping", "to help"], correct: 0, explanation: "使役動詞 have + 人 + 原形不定詞（人に～してもらう）の形です。help が正解です。" },
                            { text: "A suspect was injured in a police chase and taken to a hospital, according to a statement _______ from Gale County sheriff.", options: ["write", "written", "writing", "wrote"], correct: 1, explanation: "statement（声明）を修飾します。「書かれた」声明なので過去分詞 written が正解です。" },
                            { text: "There is no cancellation fee, _______ that it is requested more than 60 days before the departure of the tour.", options: ["provide", "provided", "provides", "to provide"], correct: 1, explanation: "provided that ... で「～という条件で」「もし～ならば」という接続詞的な働きをします。" }
                        ]
                    },
                    {
                        id: "L1_REVIEW",
                        title: "Review Quiz",
                        type: "grammar",
                        questions: [
                            { text: "Marie Chang was _______ to accompany the president just two days before the business trip.", options: ["assign", "assigned", "assigning", "to assign"], correct: 1, explanation: "「任命された」という受動態です。assigned が正解です。" },
                            { text: "It is strongly suggested that smoking and drinking _______ avoided during pregnancy.", options: ["are", "be", "were", "will be"], correct: 1, explanation: "提案(suggest)の後のthat節内なので、動詞の原形 be を使います。" },
                            { text: "Lea Johnson was extremely proud to have her design _______ for the new building.", options: ["choose", "choosing", "chose", "chosen"], correct: 3, explanation: "have + 目的語 + 過去分詞（～してもらう／される）。デザインが「選ばれた」ので chosen です。" },
                            { text: "Due to mechanical difficulties, the FER flight was _______ by three hours.", options: ["delay", "delayed", "delaying", "delays"], correct: 1, explanation: "受動態「遅延した」です。delayed が正解です。" },
                            { text: "The advisory panel agreed the new guidelines will _______ tentatively for two years, followed by a review.", options: ["be implemented", "be implementing", "have implemented", "implement"], correct: 0, explanation: "ガイドラインは「実施される」ものなので、受動態の be implemented が正解です。" },
                            { text: "In order to combat the heat, employees _______ to dress more casually and drink plenty of fluids.", options: ["are encouraged", "encourage", "encouraged", "encouraging"], correct: 0, explanation: "従業員は「推奨されている」ので、受動態の are encouraged です。" },
                            { text: "Customers responded very positively to the newly _______ website and print catalog.", options: ["design", "designed", "designing", "to design"], correct: 1, explanation: "「新しくデザインされた」ウェブサイト。過去分詞 designed が形容詞的に働きます。" },
                            { text: "If a sofa bed _______, then there will be an additional charge of $25 per night.", options: ["is required", "is requiring", "require", "requires"], correct: 0, explanation: "「もしソファベッドが必要とされるなら」という受動の意味。is required が正解です。" }
                        ]
                    }
                ]
            },
            {
                id: "L2",
                title: "Lesson 2: Part 6 動詞(2)",
                sections: [
                    {
                        id: "L2_TARGET",
                        title: "TODAY'S TARGET TEST (Text Completion)",
                        type: "reading",
                        content: "Please be informed that effective September 1, all requests for vacation or sick leave must be filed through the company intranet site. Click on 'Leave Request' to access the form you [1]. All paper forms currently [2] will be collected by supervisors and managers for recycling.\n\nSocial responsibility is part of our company's mission statement, and this is one way to put into practice what we believe. Please join us in our promotion of a paperless environment in this company, a small effort [3] the global environment.",
                        questions: [
                            { text: "[1] Select the best answer.", options: ["need", "needed", "needing", "needs"], correct: 0, explanation: "関係代名詞が省略されています。the form (that) you need（あなたが必要とするフォーム）。現在形の文脈なので need です。" },
                            { text: "[2] Select the best answer.", options: ["being used", "to be used", "use", "using"], correct: 0, explanation: "「現在使われている」すべての紙のフォーム。currently being used（現在進行形の受動態の分詞用法）が適切です。" },
                            { text: "[3] Select the best answer.", options: ["help", "helped", "helping", "to help"], correct: 3, explanation: "「地球環境を助けるための」小さな努力。不定詞の形容詞的用法 to help が適切です。" }
                        ]
                    },
                    {
                        id: "L2_REVIEW",
                        title: "Review Quiz",
                        type: "reading",
                        content: "Jasper Enterprises [1] yesterday that as of November 18, the new chief of operations will be Veronica Holmes. Ms. Holmes comes to Jasper from Monroe Group, where she has served as marketing vice president for the past five years. Ms. Holmes will be concentrating on domestic operations, [2] up Michael Roberts, the company's owner, to concentrate on public relations and his new project tentatively [3] as Jasper Global Initiatives.",
                        questions: [
                            { text: "[1] Select the best answer.", options: ["announce", "announced", "announces", "announcing"], correct: 1, explanation: "yesterday（昨日）があるので過去形 announced が正解です。" },
                            { text: "[2] Select the best answer.", options: ["free", "freed", "freeing", "frees"], correct: 2, explanation: "分詞構文です。「Michael Robertsを自由にさせる（解放する）ことで」。能動の意味なので freeing です。" },
                            { text: "[3] Select the best answer.", options: ["knew", "know", "knowing", "known"], correct: 3, explanation: "「～として知られている」プロジェクト。過去分詞 known が正解です。" }
                        ]
                    }
                ]
            },
            {
                id: "L7",
                title: "Lesson 7: Part 5 関係詞(1)",
                sections: [
                    {
                        id: "L7_TARGET",
                        title: "TODAY'S TARGET TEST",
                        type: "grammar",
                        questions: [
                            { text: "According to a recent study, those _______ regularly read food labels tend to be healthier.", options: ["what", "when", "where", "who"], correct: 3, explanation: "those who ... で「～する人々」という定番表現です。" },
                            { text: "_______ today's board meeting ends, Ms. Kane will have her staff clean the conference room.", options: ["When", "Which", "Who", "Why"], correct: 0, explanation: "「～する時」という接続詞 When が適切です。" },
                            { text: "Ava Watson has a large collection of rare stamps, some of _______ were issued about 100 years ago.", options: ["that", "what", "which", "whom"], correct: 2, explanation: "「some of + 関係代名詞」の形。先行詞がスタンプ（物）なので which を使います。" },
                            { text: "Although Kate Takeda recommended the latest digital camera, the customer wanted a camera _______ lens is detachable.", options: ["that", "which", "whose", "what"], correct: 2, explanation: "「そのレンズが」取り外し可能なカメラ。所有格の関係代名詞 whose が正解です。" },
                            { text: "The branch manager decided to conduct a survey to find out _______ the employees think of the updated intranet.", options: ["that", "what", "which", "whose"], correct: 1, explanation: "find outの目的語となる間接疑問文。「従業員が何を考えているか」なので what です。" },
                            { text: "According to the social media marketer, this artificial intelligence program allows you to monitor _______ people are interested in.", options: ["that", "what", "which", "whose"], correct: 1, explanation: "monitorの目的語。「人々が何に興味を持っているか（人々が興味を持っていること）」なので what が正解です。" },
                            { text: "Five companies are nominated for this year's Global Business of the Year award, none of _______ have ever won in the past.", options: ["that", "them", "what", "which"], correct: 3, explanation: "継続用法の関係代名詞。先行詞が会社（物・組織）で、前置詞 of の後なので which が正解です。" },
                            { text: "The Ubermaster 9X is the likeliest product _______ Techstar, Inc. can get back into the black the next year.", options: ["how", "when", "whereby", "why"], correct: 2, explanation: "「それによって～できる」という手段を表す関係副詞的用法。whereby（＝by which）が文脈に合います。" },
                             { text: "Any revisions to the regulations shall be given to the parties concerned _______ may object to such modifications if they wish.", options: ["which", "who", "whom", "whose"], correct: 1, explanation: "先行詞は parties concerned（関係者たち）なので、人を指す主格の関係代名詞 who が正解です。" },
                            { text: "After the division manager's lengthy small talk, the meeting finally came to the point _______ the real agenda was discussed.", options: ["what", "when", "where", "which"], correct: 2, explanation: "point（時点・段階）を先行詞とし、「その段階で」議題が話し合われたので、場所・状況を表す where が適切です。" },
                            { text: "After long consideration, the personnel chief chose the candidate _______ major was electrical engineering.", options: ["that", "which", "whom", "whose"], correct: 3, explanation: "「その専攻が」電気工学である候補者。所有格 whose が正解です。" },
                            { text: "Despite being married for over 50 years, Mr. Hunter still remembered vividly the moment _______ he first saw his wife.", options: ["when", "where", "which", "whose"], correct: 0, explanation: "moment（瞬間）という時を表す先行詞を受ける関係副詞 when が正解です。" },
                            { text: "For the first time, Ms. Hathaway was in a situation _______ her potential client hesitated to close the deal.", options: ["how", "when", "where", "why"], correct: 2, explanation: "situation（状況）を受ける関係副詞は where が一般的です。" },
                            { text: "Because of the last-minute venue change, the promoter had to contact all the attendees _______ had registered for the event.", options: ["that", "what", "which", "whom"], correct: 0, explanation: "attendees（出席者・人）を先行詞とする主格の関係代名詞。who がないため that を使います。" },
                            { text: "The chairperson had to choose the idea _______ she liked best, but none of them really appealed to her.", options: ["that", "what", "where", "whose"], correct: 0, explanation: "idea（物）を先行詞とする目的格の関係代名詞。which か that ですが、選択肢にある that が正解です。" },
                            { text: "This afternoon, Benjamin Lucas ran across one of his business contacts _______ he had known for a long time.", options: ["what", "which", "whom", "whose"], correct: 2, explanation: "contacts（連絡先・知人）という人を指す先行詞で、目的格（彼を知っていた）なので whom が正解です。" }
                        ]
                    },
                    {
                        id: "L7_REVIEW",
                        title: "Review Quiz",
                        type: "grammar",
                        questions: [
                            { text: "Nobody knew _______ Theo Cain had done for a living before joining our company.", options: ["as", "that", "what", "which"], correct: 2, explanation: "knewの目的語。「何をして生計を立てていたか」なので what です。" },
                            { text: "Amelia Kowalski is the most competent and caring secretary _______ I have ever worked with.", options: ["that", "where", "which", "whose"], correct: 0, explanation: "最上級(the most...)を含む先行詞の場合、関係代名詞は that が好まれます。" },
                            { text: "The hotels and restaurants in Huntsfield get busy in winter _______ lots of foreign tourists come.", options: ["when", "where", "which", "whose"], correct: 0, explanation: "winter（時）を説明する関係副詞 when が正解です。" },
                            { text: "The house _______ the famous artist grew up was turned into a local tourist attraction.", options: ["for which", "in which", "of whom", "whenever"], correct: 1, explanation: "「その家の中で(in the house)」育ったので、in which (=where) が正解です。" },
                            { text: "A special bonus will be given to the managers _______ departments or branches achieve their goals this year.", options: ["that", "which", "whom", "whose"], correct: 3, explanation: "「その（マネージャーの）部署が」目標を達成した。所有格 whose が正解です。" },
                            { text: "Today Times features an interview of Razak Wan, a high school dropout _______ turned into a successful businessman.", options: ["which", "who", "whom", "whose"], correct: 1, explanation: "先行詞は dropout（人）。主格の関係代名詞 who が正解です。" },
                            { text: "Gabriel Dupont didn't realize that his new client is a woman _______ he met at a business seminar last year.", options: ["which", "who", "whom", "whose"], correct: 2, explanation: "先行詞は woman。彼が「会った(met)」相手なので目的格の whom です（whoも可ですが選択肢でより適切なのはwhom）。" },
                            { text: "The prominent author wrote a new novel, _______ is rumored to be based on her childhood in China.", options: ["what", "which", "whose", "why"], correct: 1, explanation: "先行詞は novel。カンマがあるので非制限用法。「そしてそれは～」と続くため which が正解です。" }
                        ]
                    }
                ]
            },
            {
                id: "L10",
                title: "Lesson 10: Part 5 文と文のつながり(1)",
                sections: [
                    {
                        id: "L10_TARGET",
                        title: "TODAY'S TARGET TEST",
                        type: "grammar",
                        questions: [
                            { text: "Aquaman The Ride has been a popular attraction in the amusement park _______ it opened last year.", options: ["as", "because", "since", "when"], correct: 2, explanation: "現在完了形(has been)と一緒に使われ、「～以来」を表す since が正解です。" },
                            { text: "_______ the budget for the new city hall is limited, it will not be very difficult or expensive to find a decent builder.", options: ["As long as", "Even if", "In case", "So that"], correct: 1, explanation: "文脈的に逆接。「予算が限られているとしても、見つけるのは難しくない」となるため Even if（たとえ～でも）が正解です。" },
                            { text: "_______ he is inexperienced as a lecturer, the doctor had the ability to speak clearly in public and connect with listeners.", options: ["Although", "If", "Whether", "When"], correct: 0, explanation: "「経験不足であるにもかかわらず」。逆接の接続詞 Although が正解です。" },
                            { text: "The technician's explanation of the new system was way too complicated, _______ it had to be rewritten in simpler words.", options: ["and", "but", "if", "or"], correct: 0, explanation: "「複雑すぎた、そして（だから）書き直さなければならなかった」。順接の and が自然です。（soがあればsoですが、選択肢の中ではandで結果をつなぎます）" },
                            { text: "Under the new policy, the telecom giant, XYZ Wires will have to consult with communities _______ they build a new tower.", options: ["across", "before", "beyond", "until"], correct: 1, explanation: "「新しい塔を建てる前に」。時を表す接続詞 before が正解です。" },
                            { text: "_______ the students arrived at the station, the express had just left and they had to wait 20 minutes for the next one.", options: ["Because", "If", "When", "While"], correct: 2, explanation: "「駅に着いた時」。When が正解です。" },
                            { text: "The brother patiently taught his sister how to solve the equation _______ she completely understood it.", options: ["since", "until", "when", "whether"], correct: 1, explanation: "「完全に理解するまで」。継続の終点を表す until が正解です。" },
                            { text: "John Berg went to his office to talk with his boss _______ he returned from his overseas business trip.", options: ["as far as", "once", "so that", "whereas"], correct: 1, explanation: "「戻ったらすぐに」。once（いったん～すると、～するとすぐに）が正解です。" },
                            { text: "According to your résumé, you have sufficient experience in web design; _______ we would like to set up an interview with you.", options: ["likewise", "otherwise", "therefore", "yet"], correct: 2, explanation: "「十分な経験がある。したがって(therefore)、面接を設定したい」。因果関係を示す副詞です。" },
                            { text: "_______ you agree with our Privacy Policy and Terms of Use, please click 'I ACCEPT' below.", options: ["Unless", "When", "If", "Whether"], correct: 2, explanation: "「もし同意するなら」。条件を表す If が正解です。" },
                            { text: "_______ he was exhausted and wanted to go home, Mark Gordon went for a drink with his colleague to keep him company.", options: ["As for", "Because", "During", "Even though"], correct: 3, explanation: "「疲れていたにもかかわらず」。譲歩を表す Even though が正解です。" },
                            { text: "_______ it rains, the event will be held outside from 1:00 to 3:00 on October 24th.", options: ["As long as", "In case", "Since", "Unless"], correct: 3, explanation: "「雨が降らない限り」。Unless（もし～なければ）が文脈に合います。" },
                            { text: "The CEO was not fully satisfied with the contract terms offered by Livetell, Inc., _______ he signed it anyway.", options: ["and", "but", "or", "unless"], correct: 1, explanation: "「満足していなかったが、サインした」。逆接の but が正解です。" },
                            { text: "The product development team made a prototype of the new product, but it appears _______ there is a design flaw.", options: ["as though", "even if", "in case", "so that"], correct: 0, explanation: "it appears as though ... で「まるで～のように見える」。" },
                            { text: "Mike Grant was told that his surgery was successful; _______ he still felt chest pain.", options: ["consequently", "furthermore", "otherwise", "nevertheless"], correct: 3, explanation: "「手術は成功したと言われた。それにもかかわらず(nevertheless)、痛みを感じた」。" },
                            { text: "_______ the old operating system was quite complicated, the new one is simple and user-friendly.", options: ["As", "If", "When", "Whereas"], correct: 3, explanation: "対比を表す接続詞。「古いOSが複雑だったのに対し(Whereas)」。" }
                        ]
                    },
                    {
                        id: "L10_REVIEW",
                        title: "Review Quiz",
                        type: "grammar",
                        questions: [
                            { text: "_______ your résumé shows that you have a good track record in accounting, you unfortunately do not meet all our requirements.", options: ["Although", "Because", "Since", "So"], correct: 0, explanation: "「良い実績があるが（あるけれども）」。譲歩の Although が正解です。" },
                            { text: "Go straight three blocks, _______ you will find the hotel on your right, next to the city park.", options: ["and", "but", "or", "so"], correct: 0, explanation: "「命令文 + and」で「～しなさい、そうすれば...」の形です。" },
                            { text: "Please refrain from smoking in front of the door _______ it blocks the way of delivery personnel.", options: ["because", "if", "unless", "until"], correct: 0, explanation: "「なぜなら～だから」。理由を表す because が正解です。" },
                            { text: "Bill Cain had never heard of the up-and-coming company; _______ he could not say anything when his boss asked him about it.", options: ["however", "meanwhile", "nonetheless", "therefore"], correct: 3, explanation: "「聞いたことがなかった。したがって(therefore)何も言えなかった」。" },
                            { text: "_______ you sign up with our service, you can download any movie or show you want.", options: ["As", "Before", "Once", "Though"], correct: 2, explanation: "「いったん登録すれば」。条件・時を表す Once が正解です。" },
                            { text: "Peter Berg had been afraid of heights ever _______ he was a boy and had fallen out of a tree.", options: ["after", "as", "since", "when"], correct: 2, explanation: "ever since ... 「～以来ずっと」。" },
                            { text: "_______ the boss said Naomi Watson's idea was interesting, he seemed unenthusiastic.", options: ["As long as", "Due to", "Even though", "Instead of"], correct: 2, explanation: "「面白いと言ったにもかかわらず(Even though)」。" },
                            { text: "_______ your order is shipped, you will receive an e-mail with shipping details as well as the delivery date.", options: ["Since", "Unless", "When", "While"], correct: 2, explanation: "「発送された時(When)」。" }
                        ]
                    }
                ]
            },
            {
                id: "L13",
                title: "Lesson 13: Part 5 語彙(2)",
                sections: [
                    {
                        id: "L13_TARGET",
                        title: "TODAY'S TARGET TEST",
                        type: "grammar",
                        questions: [
                            { text: "We may disclose your medical records to doctors, nurses or other hospital _______ who are involved in your care.", options: ["colonel", "model", "panel", "personnel"], correct: 3, explanation: "病院の「職員」なので personnel が正解です。" },
                            { text: "The Purple Dawn is a classic musical which has also made a great _______ to popular music.", options: ["adaptation", "contribution", "donation", "evolution"], correct: 1, explanation: "make a contribution to ... で「～に貢献する」。" },
                            { text: "We will not be responsible for any _______ or malfunction that is caused as a result of product misuse.", options: ["defect", "effect", "insect", "neglect"], correct: 0, explanation: "製品の「欠陥」。defect が正解です。" },
                            { text: "At the stockholders' meeting, the CEO thanked _______ for trusting him and helping him to grow his business.", options: ["ambassadors", "investors", "predecessors", "vendors"], correct: 1, explanation: "株主総会での話なので、感謝する相手は「投資家たち(investors)」です。" },
                            { text: "The _______ conducted by the research firm showed that the number of smartphone users is much lower than expected.", options: ["convention", "survey", "vote", "workshop"], correct: 1, explanation: "調査会社によって行われた「調査」。survey が正解です。" },
                            { text: "As part of cost _______ measures, the company had to let go 200 employees including long serving ones.", options: ["elimination", "introduction", "prediction", "reduction"], correct: 3, explanation: "コスト「削減」策。reduction が正解です。" },
                            { text: "The company's regulations require that thorough equipment _______ be performed at all the factories every 60 days.", options: ["indications", "infections", "inspections", "invitations"], correct: 2, explanation: "機器の「点検」。inspections が正解です。" },
                            { text: "The shepherd has a habit of counting his sheep every night to make sure that _______ all there.", options: ["it", "it's", "their", "they're"], correct: 3, explanation: "sheep（複数）を受ける代名詞。「彼らがそこにいる」＝ they are (they're) が正解です。" },
                            { text: "This fall, Plasma Tech Inc. is offering a new line of digital metering products that are compact, _______ and reasonably priced.", options: ["consistent", "convenient", "insistent", "present"], correct: 1, explanation: "製品の特徴として「便利な(convenient)」が適切です。" },
                            { text: "Due to her enthusiasm and pleasant personality, Monica Keen has become a _______ member of the sales team.", options: ["durable", "portable", "stable", "valuable"], correct: 3, explanation: "「貴重な(valuable)」メンバー。" },
                            { text: "All employees are required to go to Conference Room A for their _______ checkup by 5:00 p.m. today.", options: ["annual", "chronological", "impractical", "temporal"], correct: 0, explanation: "「年一回の(annual)」健康診断。" },
                            { text: "The boss thought Marian Colton's idea for the new advertisement campaign was _______ but not excellent.", options: ["acceptable", "accessible", "affordable", "available"], correct: 0, explanation: "「悪くはない（許容範囲だ）が、素晴らしくはない」。acceptable が文脈に合います。" },
                            { text: "Although the train is usually packed, the office worker was fortunate to find an _______ seat this morning.", options: ["unattended", "uncontrolled", "undetermined", "unoccupied"], correct: 3, explanation: "「空いている(unoccupied)」席。" },
                            { text: "It took a whole day for the accountant to compare the previous year's financial statements with those of the _______ year.", options: ["current", "modern", "recent", "updated"], correct: 0, explanation: "前年と比較するのは「今年度(current)」です。" },
                            { text: "Two _______ phone calls to the police led to the arrest of the suspect in the bank robbery that occurred last week.", options: ["anonymous", "enormous", "synonymous", "unanimous"], correct: 0, explanation: "「匿名の(anonymous)」電話。" },
                            { text: "We truly believe that our shoes are your best choice for their _______ quality and reasonable price.", options: ["inferior", "major", "senior", "superior"], correct: 3, explanation: "「優れた(superior)」品質。" }
                        ]
                    }
                ]
            },
            {
                id: "L14",
                title: "Lesson 14: Review Test",
                sections: [
                    {
                        id: "L14_REVIEW",
                        title: "PART 5 & 6 & 7 総復習",
                        type: "grammar",
                        questions: [
                            { text: "_______ as the project leader, Scott Thorne delegated various tasks to his team members at the meeting.", options: ["Being chosen", "Choose", "Choosing", "Chose"], correct: 0, explanation: "Part 5復習: (A) Being chosen が正解です。" },
                            { text: "Under the new policy, the telecom giant, XYZ Wires will have to consult with neighboring communities _______ they build a new tower.", options: ["across", "before", "beyond", "until"], correct: 1, explanation: "Part 5復習: 建てる「前に」。(B) before が正解です。" },
                            { text: "Gina Carson could not give a prompt reply when _______ a managerial position at a rival company.", options: ["offer", "offered", "offering", "offers"], correct: 1, explanation: "Part 5復習: オファーされた時。(B) offered が正解です。" },
                            { text: "The layout of our official website will be renewed once _______ two years.", options: ["all", "both", "each", "every"], correct: 3, explanation: "Part 5復習: every two years で「2年ごとに」。(D) every が正解です。" },
                            { text: "The teacher saw his students at the park talking with some friends of _______.", options: ["their", "theirs", "them", "they"], correct: 1, explanation: "Part 5復習: friends of theirs（彼らの友人）。(B) theirs が正解です。" },
                            { text: "_______ he was exhausted and wanted to go home, Mark Gordon went for a drink with his colleague to keep him company.", options: ["As for", "Because", "During", "Even though"], correct: 3, explanation: "Part 5復習: 逆接。(D) Even though が正解です。" },
                            { text: "John Berg went to his office to talk with his boss _______ he returned from his overseas business trip.", options: ["as far as", "once", "so that", "whereas"], correct: 1, explanation: "Part 5復習: 戻ったらすぐに。(B) once が正解です。" },
                            { text: "The prominent author wrote a new novel, _______ is rumored to be based on her childhood in China.", options: ["what", "which", "whose", "why"], correct: 1, explanation: "Part 5復習: 非制限用法の関係代名詞。(B) which が正解です。" },
                            { text: "The Purple Dawn is a classic musical which has also made a great _______ to popular music.", options: ["adaptation", "contribution", "donation", "evolution"], correct: 1, explanation: "Part 5復習: 貢献。(B) contribution が正解です。" },
                            { text: "For _______ who are interested in starting up their own business, please click the button below.", options: ["that", "these", "this", "those"], correct: 3, explanation: "Part 5復習: those who（～する人々）。(D) those が正解です。" },
                            { text: "Mike Grant was told that his surgery was successful; _______ he still felt chest pain.", options: ["consequently", "furthermore", "otherwise", "nevertheless"], correct: 3, explanation: "Part 5復習: それにもかかわらず。(D) nevertheless が正解です。" },
                            { text: "All employees are required to go to Conference Room A for their _______ checkup by 5:00 p.m. today.", options: ["annual", "chronological", "impractical", "temporal"], correct: 0, explanation: "Part 5復習: 年次の。(A) annual が正解です。" },
                            { text: "Mr. Jang, recognizing the importance of the project, offered to organize and lead the task force team _______.", options: ["he", "him", "himself", "his"], correct: 2, explanation: "Part 5復習: 彼自身で。(C) himself が正解です。" },
                            { text: "Bill Cain had never heard of the company; _______ he could not say anything when his boss asked him about it.", options: ["however", "meanwhile", "nonetheless", "therefore"], correct: 3, explanation: "Part 5復習: したがって。(D) therefore が正解です。" },
                            { text: "After long consideration, the personnel chief chose the candidate _______ major was electrical engineering.", options: ["that", "which", "whom", "whose"], correct: 3, explanation: "Part 5復習: 所有格。(D) whose が正解です。" },
                            { text: "As part of cost _______ measures, the company had to let go 200 employees including long serving ones.", options: ["elimination", "introduction", "prediction", "reduction"], correct: 3, explanation: "Part 5復習: コスト削減。(D) reduction が正解です。" }
                        ]
                    }
                ]
            }
        ];

        // --- COMPONENTS ---

        function App() {
            const [view, setView] = useState('menu'); // 'menu', 'lesson', 'quiz', 'result'
            const [activeLessonId, setActiveLessonId] = useState(null);
            const [activeSectionId, setActiveSectionId] = useState(null);
            const [completedQuestions, setCompletedQuestions] = useState({}); // { [questionHash]: true }
            
            // Session State
            const [quizQueue, setQuizQueue] = useState([]);
            const [currentQIndex, setCurrentQIndex] = useState(0);
            const [stats, setStats] = useState({ correct: 0, wrong: 0 });
            const [feedback, setFeedback] = useState(null); // { type: 'correct'|'wrong', explanation: string }

            // Helper to generate a somewhat unique ID for questions based on text
            const getQId = (text) => text.substring(0, 15) + text.length;

            const startSection = (lessonId, sectionId) => {
                const lesson = APP_DATA.find(l => l.id === lessonId);
                const section = lesson.sections.find(s => s.id === sectionId);
                
                // Filter out completed questions
                const queue = section.questions.map(q => ({
                    ...q,
                    id: getQId(q.text)
                })).filter(q => !completedQuestions[q.id]);

                if (queue.length === 0) {
                    if(confirm("全問正解済みです。リセットして復習しますか？")) {
                        const resetQueue = section.questions.map(q => ({ ...q, id: getQId(q.text) }));
                        setQuizQueue(resetQueue);
                        const newCompleted = {...completedQuestions};
                        resetQueue.forEach(q => delete newCompleted[q.id]);
                        setCompletedQuestions(newCompleted);
                    } else {
                        return;
                    }
                } else {
                    setQuizQueue(queue);
                }

                setActiveLessonId(lessonId);
                setActiveSectionId(sectionId);
                setCurrentQIndex(0);
                setStats({ correct: 0, wrong: 0 });
                setView('quiz');
            };

            const handleAnswer = (selectedIndex) => {
                const currentQ = quizQueue[currentQIndex];
                const isCorrect = selectedIndex === currentQ.correct;

                setFeedback({
                    type: isCorrect ? 'correct' : 'wrong',
                    explanation: currentQ.explanation
                });
            };

            const nextQuestion = () => {
                const currentQ = quizQueue[currentQIndex];
                const isCorrect = feedback.type === 'correct';
                
                setFeedback(null);

                if (isCorrect) {
                    setCompletedQuestions(prev => ({ ...prev, [currentQ.id]: true }));
                    setStats(prev => ({ ...prev, correct: prev.correct + 1 }));
                    
                    if (currentQIndex >= quizQueue.length - 1) {
                        setView('result');
                    } else {
                        setCurrentQIndex(prev => prev + 1);
                    }
                } else {
                    setStats(prev => ({ ...prev, wrong: prev.wrong + 1 }));
                    // 間違えたらキューの最後に追加（徹底復習）
                    setQuizQueue(prev => [...prev, currentQ]);
                    setCurrentQIndex(prev => prev + 1);
                }
            };

            // Views
            if (view === 'menu') return <MenuView data={APP_DATA} onSelectLesson={(id) => { setActiveLessonId(id); setView('lesson'); }} completedMap={completedQuestions} getQId={getQId} />;
            if (view === 'lesson') return <LessonView lesson={APP_DATA.find(l => l.id === activeLessonId)} onBack={() => setView('menu')} onStartSection={startSection} completedMap={completedQuestions} getQId={getQId} />;
            if (view === 'quiz') return <QuizView 
                question={quizQueue[currentQIndex]} 
                total={quizQueue.length} 
                current={currentQIndex + 1} 
                onAnswer={handleAnswer} 
                feedback={feedback}
                onNext={nextQuestion}
                onExit={() => setView('lesson')}
            />;
            if (view === 'result') return <ResultView stats={stats} onBack={() => setView('lesson')} />;
            
            return null;
        }

        const MenuView = ({ data, onSelectLesson, completedMap, getQId }) => (
            <div className="max-w-md mx-auto min-h-screen pb-10">
                <header className="bg-white p-6 shadow-sm sticky top-0 z-10">
                    <div className="flex justify-between items-center">
                        <h1 className="text-2xl font-black text-slate-800 tracking-tighter">English Master</h1>
                        <Icons.Trophy className="text-yellow-500 w-6 h-6" />
                    </div>
                    <p className="text-slate-500 text-xs font-bold uppercase mt-1">Basic English II</p>
                </header>
                <div className="p-4 space-y-4">
                    {data.map(lesson => {
                        const totalQ = lesson.sections.reduce((acc, s) => acc + s.questions.length, 0);
                        const doneQ = lesson.sections.reduce((acc, s) => acc + s.questions.filter(q => completedMap[getQId(q.text)]).length, 0);
                        const progress = Math.round((doneQ / totalQ) * 100);
                        
                        return (
                            <button key={lesson.id} onClick={() => onSelectLesson(lesson.id)} className="w-full bg-white p-5 rounded-2xl shadow-sm border border-slate-100 active:scale-95 transition-transform text-left group">
                                <div className="flex justify-between items-start mb-2">
                                    <span className="text-xs font-bold text-indigo-500 bg-indigo-50 px-2 py-1 rounded uppercase tracking-wide">Unit</span>
                                    {progress === 100 ? <Icons.Star className="w-5 h-5 text-yellow-400 fill-current" /> : <span className="text-xs font-bold text-slate-400">{progress}%</span>}
                                </div>
                                <h3 className="text-lg font-bold text-slate-800 leading-tight mb-4 group-hover:text-indigo-600 transition-colors">{lesson.title}</h3>
                                <div className="w-full bg-slate-100 h-1.5 rounded-full overflow-hidden">
                                    <div className={`h-full ${progress === 100 ? 'bg-green-500' : 'bg-indigo-500'} transition-all duration-500`} style={{ width: `${progress}%` }}></div>
                                </div>
                            </button>
                        );
                    })}
                </div>
            </div>
        );

        const LessonView = ({ lesson, onBack, onStartSection, completedMap, getQId }) => (
            <div className="max-w-md mx-auto min-h-screen bg-slate-50 flex flex-col">
                <header className="bg-white p-4 shadow-sm flex items-center gap-3 sticky top-0 z-10">
                    <button onClick={onBack} className="p-2 hover:bg-slate-100 rounded-full transition-colors"><Icons.ArrowLeft className="w-6 h-6 text-slate-600" /></button>
                    <h2 className="text-lg font-bold text-slate-800 truncate">{lesson.title}</h2>
                </header>
                <div className="p-4 space-y-4 flex-1">
                    {lesson.sections.map(section => {
                        const total = section.questions.length;
                        const done = section.questions.filter(q => completedMap[getQId(q.text)]).length;
                        const isComplete = total === done;
                        
                        return (
                            <button key={section.id} onClick={() => onStartSection(lesson.id, section.id)} className={`w-full p-6 rounded-3xl text-left border-2 transition-all shadow-sm active:scale-95 relative overflow-hidden group ${section.id.includes('TARGET') ? 'bg-white border-blue-100 hover:border-blue-300' : 'bg-white border-purple-100 hover:border-purple-300'}`}>
                                <div className={`absolute top-0 right-0 p-3 rounded-bl-2xl text-[10px] font-bold uppercase tracking-widest ${section.id.includes('TARGET') ? 'bg-blue-50 text-blue-600' : 'bg-purple-50 text-purple-600'}`}>
                                    {section.type === 'reading' ? 'Reading' : 'Grammar'}
                                </div>
                                <h3 className={`text-xl font-black mb-2 ${section.id.includes('TARGET') ? 'text-blue-900' : 'text-purple-900'}`}>{section.title}</h3>
                                {isComplete ? (
                                    <div className="flex items-center gap-2 text-green-600 font-bold text-sm bg-green-50 px-3 py-1.5 rounded-lg w-fit">
                                        <Icons.CheckCircle className="w-4 h-4" /> Complete
                                    </div>
                                ) : (
                                    <div className="flex items-center gap-2 text-slate-500 font-bold text-sm bg-slate-100 px-3 py-1.5 rounded-lg w-fit group-hover:bg-indigo-50 group-hover:text-indigo-600 transition-colors">
                                        <Icons.Play className="w-4 h-4 fill-current" /> {total - done} Questions
                                    </div>
                                )}
                            </button>
                        );
                    })}
                </div>
            </div>
        );

        const QuizView = ({ question, total, current, onAnswer, feedback, onNext, onExit }) => (
            <div className="max-w-md mx-auto min-h-screen bg-slate-100 flex flex-col relative">
                {/* Header */}
                <div className="px-4 py-4 flex items-center justify-between bg-white shadow-sm z-10">
                    <button onClick={onExit}><Icons.XCircle className="w-6 h-6 text-slate-400 hover:text-red-500" /></button>
                    <div className="flex-1 mx-4">
                        <div className="h-2 bg-slate-100 rounded-full overflow-hidden">
                            <div className="h-full bg-indigo-500 transition-all duration-300" style={{ width: `${(current / total) * 100}%` }}></div>
                        </div>
                    </div>
                    <span className="text-xs font-bold text-slate-400">{current}/{total}</span>
                </div>

                {/* Question Area */}
                <div className="flex-1 overflow-y-auto p-4 pb-32">
                    {/* Reading Passage if available */}
                    {question.content && (
                        <div className="bg-white p-5 rounded-xl border border-slate-200 mb-4 text-sm leading-relaxed text-slate-600 whitespace-pre-wrap font-serif">
                            <div className="flex items-center gap-2 mb-2 text-orange-500 font-bold text-xs uppercase"><Icons.BookOpen className="w-4 h-4" /> Reading</div>
                            {question.content}
                        </div>
                    )}
                    
                    <div className="bg-white p-6 rounded-2xl shadow-lg border border-slate-100 mb-6">
                        <span className="inline-block px-2 py-1 rounded bg-indigo-50 text-indigo-600 text-[10px] font-bold mb-3 uppercase tracking-wider">Question</span>
                        <h3 className="text-lg font-bold text-slate-800 leading-relaxed">
                            {question.text.split('_______').map((part, i, arr) => (
                                <span key={i}>
                                    {part}
                                    {i < arr.length - 1 && <span className="inline-block border-b-2 border-indigo-400 w-12 mx-1"></span>}
                                </span>
                            ))}
                        </h3>
                    </div>

                    <div className="space-y-3">
                        {question.options.map((opt, i) => (
                            <button 
                                key={i} 
                                onClick={() => !feedback && onAnswer(i)}
                                disabled={!!feedback}
                                className={`w-full p-4 rounded-xl border-2 text-left font-medium transition-all flex items-center gap-4 relative overflow-hidden
                                    ${feedback 
                                        ? i === question.correct 
                                            ? 'bg-green-100 border-green-500 text-green-800 shadow-md' 
                                            : 'bg-slate-50 border-slate-100 text-slate-400 opacity-50'
                                        : 'bg-white border-slate-200 hover:border-indigo-400 hover:shadow-md active:scale-[0.98]'
                                    }
                                `}
                            >
                                <div className={`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold border-2 
                                    ${feedback && i === question.correct ? 'bg-green-500 border-green-500 text-white' : 'bg-white border-slate-300 text-slate-400'}
                                `}>
                                    {String.fromCharCode(65 + i)}
                                </div>
                                {opt}
                            </button>
                        ))}
                    </div>
                </div>

                {/* Feedback Overlay Modal */}
                {feedback && (
                    <div className="fixed inset-0 z-50 flex items-end sm:items-center justify-center p-4 animate-fade-in bg-black/50 backdrop-blur-sm">
                        <div className={`w-full max-w-sm bg-white rounded-3xl p-6 shadow-2xl animate-slide-up border-b-8 ${feedback.type === 'correct' ? 'border-green-500' : 'border-red-500'}`}>
                            <div className="flex items-center gap-3 mb-4">
                                {feedback.type === 'correct' 
                                    ? <Icons.CheckCircle className="w-8 h-8 text-green-500 fill-green-100" />
                                    : <Icons.XCircle className="w-8 h-8 text-red-500 fill-red-100" />
                                }
                                <h3 className={`text-2xl font-black ${feedback.type === 'correct' ? 'text-green-600' : 'text-red-600'}`}>
                                    {feedback.type === 'correct' ? 'Correct!' : 'Incorrect...'}
                                </h3>
                            </div>
                            
                            <div className="bg-slate-50 p-4 rounded-xl border border-slate-100 mb-6">
                                <p className="text-xs font-bold text-slate-400 uppercase mb-1">Explanation</p>
                                <p className="text-slate-700 text-sm leading-relaxed font-medium">
                                    {feedback.explanation}
                                </p>
                            </div>

                            <button onClick={onNext} className={`w-full py-3.5 rounded-xl font-bold text-white shadow-lg active:scale-95 transition-transform ${feedback.type === 'correct' ? 'bg-green-500 hover:bg-green-600 shadow-green-200' : 'bg-slate-800 hover:bg-slate-900 shadow-slate-300'}`}>
                                {feedback.type === 'correct' ? 'Next Question' : 'Got it'}
                            </button>
                        </div>
                    </div>
                )}
            </div>
        );

        const ResultView = ({ stats, onBack }) => (
            <div className="max-w-md mx-auto min-h-screen bg-indigo-600 flex flex-col items-center justify-center p-6 text-center relative overflow-hidden">
                <div className="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-10"></div>
                <div className="glass-panel p-8 rounded-3xl w-full max-w-sm shadow-2xl relative z-10 animate-slide-up">
                    <div className="w-24 h-24 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-6 shadow-inner">
                        <Icons.Trophy className="w-12 h-12 text-yellow-500 drop-shadow-sm" />
                    </div>
                    <h2 className="text-3xl font-black text-slate-800 mb-2">Well Done!</h2>
                    <p className="text-slate-500 mb-8 font-medium">セッション完了です！</p>
                    
                    <div className="grid grid-cols-2 gap-4 mb-8">
                        <div className="bg-green-50 p-4 rounded-2xl">
                            <div className="text-2xl font-black text-green-600">{stats.correct}</div>
                            <div className="text-xs font-bold text-green-400 uppercase">Correct</div>
                        </div>
                        <div className="bg-red-50 p-4 rounded-2xl">
                            <div className="text-2xl font-black text-red-600">{stats.wrong}</div>
                            <div className="text-xs font-bold text-red-400 uppercase">Retry</div>
                        </div>
                    </div>

                    <button onClick={onBack} className="w-full py-4 bg-indigo-600 text-white font-bold rounded-xl shadow-lg shadow-indigo-200 hover:bg-indigo-700 transition-colors">
                        Back to Menu
                    </button>
                </div>
            </div>
        );

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
